<% if policy(Favorite.new).create? %>
<p>
  <div class="favorite">
    <% if favorite = current_user.favorited(post) %>
      <%= link_to [post, favorite], class: 'btn btn-default', method: :delete do %>
        <i class="glyphicon glyphicon-star-empty"></i>&nbsp; Unfavorite
      <% end %>
    <% else %>
      <%= link_to [post, Favorite.new], class: 'btn btn-warning', method: :post do %>
        <i class="glyphicon glyphicon-star"></i>&nbsp; Favorite
      <% end %>
    <% end %>
  </div>
</p>
<% end %>